#!/bin/bash
# claude-remote - Wrapper to run Claude Code with session naming
#
# Usage:
#   claude-remote [options] [claude args...]
#
# Options:
#   -s, --session NAME   Session name for remote control identification
#   -h, --help           Show this help
#
# Examples:
#   claude-remote                      # Start claude (uses PID as session)
#   claude-remote -s work              # Start claude with session "work"
#   claude-remote -s dev "fix the bug" # Session "dev", with prompt

set -e

# Defaults
SESSION_NAME=""
CLAUDE_ARGS=()

# Parse arguments
while [[ $# -gt 0 ]]; do
    case $1 in
        -s|--session)
            SESSION_NAME="$2"
            shift 2
            ;;
        -h|--help)
            echo "claude-remote - Wrapper to run Claude Code with session naming"
            echo ""
            echo "Usage: claude-remote [options] [claude args...]"
            echo ""
            echo "Options:"
            echo "  -s, --session NAME   Session name for remote control identification"
            echo "  -h, --help           Show this help"
            echo ""
            echo "All other arguments are passed directly to claude."
            echo ""
            echo "Examples:"
            echo "  claude-remote                      # Start claude"
            echo "  claude-remote -s work              # Session named 'work'"
            echo "  claude-remote -s dev \"fix bug\"    # Session 'dev', with prompt"
            exit 0
            ;;
        *)
            CLAUDE_ARGS+=("$1")
            shift
            ;;
    esac
done

if ! command -v claude &>/dev/null; then
    echo "Error: claude is not installed."
    exit 1
fi

# Run claude as a child process (no exec!) so this script remains as parent.
# The server finds claude processes and looks at their parent (PPID) to find
# claude-remote and extract the -s argument from it.
claude "${CLAUDE_ARGS[@]}"
